<br />
<main role="main" class="container mt-5">
  <div class="card">
    <div class="card-header">
      <strong>System Settings</strong>
    </div>

    <div class="card-body">
      <form (submit)="updateSettings()" class="form">
        <div class="row">
          <div class="form-group col col-sm-6">
            <label for="labID" class="col-form-label-sm">Lab Code/ID</label>
            <input
              type="text"
              [(ngModel)]="settings.labID"
              name="labID"
              class="form-control form-control-sm"
              placeholder="Lab Code/ID"
              required
            />
          </div>
          <div class="form-group col col-sm-6">
            <label for="labName" class="col-form-label-sm">Lab Name</label>
            <input
              type="text"
              [(ngModel)]="settings.labName"
              name="labName"
              class="form-control form-control-sm"
              placeholder="Lab Name"
              required
            />
          </div>
        </div>
        <hr />
        <div class="row">
          <div class="form-group col col-sm-6">
            <label for="analyzerMachineName" class="col-form-label-sm"
              >Analyzer/Machine Name</label
            >
            <input
              type="text"
              [(ngModel)]="settings.analyzerMachineName"
              name="analyzerMachineName"
              class="form-control form-control-sm"
              placeholder="eg. Roche Cobas48"
              required
            />
          </div>
          <div class="form-group col col-sm-6">
            <label for="analyzerMachineHost" class="col-form-label-sm"
              >Analyzer/Machine IP Address</label
            >
            <input
              type="text"
              [(ngModel)]="settings.analyzerMachineHost"
              name="analyzerMachineHost"
              class="form-control form-control-sm"
              placeholder="eg. 198.1.1.1"
              required
            />
          </div>
          <div class="form-group col col-sm-6">
            <label for="analyzerMachinePort" class="col-form-label-sm"
              >Analyzer/Machine Port no.</label
            >
            <input
              type="text"
              [(ngModel)]="settings.analyzerMachinePort"
              name="analyzerMachinePort"
              class="form-control form-control-sm"
              placeholder="eg. 3120"
              required
            />
          </div>
          <div class="form-group col col-sm-6">
            <label
              for="interfaceCommunicationProtocol"
              class="col-form-label-sm"
              >Interface Communication Protocol</label
            >
            <select
              [(ngModel)]="settings.interfaceCommunicationProtocol"
              name="interfaceCommunicationProtocol"
              class="form-control form-control-sm"
            >
              <option>-- Select --</option>
              <option value="astm-elecsys">ASTM/Elecsys (Single Record)</option>
              <option value="astm-concatenated">ASTM (Concatenated)</option>
              <option value="hl7">HL7</option>
            </select>
          </div>
          <div class="form-group col col-sm-6">
            <label for="interfaceConnectionMode" class="col-form-label-sm"
              >This Interface Tool is a</label
            >
            <select
              [(ngModel)]="settings.interfaceConnectionMode"
              name="interfaceConnectionMode"
              class="form-control form-control-sm"
            >
              <option>-- Select --</option>
              <option value="tcpserver">Server (TCP/IP)</option>
              <option value="tcpclient">Client (TCP/IP)</option>
            </select>
          </div>
          <div class="form-group col col-sm-6">
            <label for="interfaceAutoConnect" class="col-form-label-sm"
              >Should the interface attempt to autoconnect?</label
            >
            <select
              [(ngModel)]="settings.interfaceAutoConnect"
              name="interfaceAutoConnect"
              class="form-control form-control-sm"
            >
              <option>-- Select --</option>
              <option value="yes">Yes</option>
              <option value="no">No</option>
            </select>
          </div>
          <div class="form-group col col-sm-6">
            <label for="appPath" class="col-form-label-sm"
              >SQLite DB Path</label
            >
            <input
              type="text"
              [(ngModel)]="appPath"
              name="appPath"
              class="form-control form-control-sm"
              readonly
            />
          </div>
          <div class="form-group col col-sm-6">
            <label for="authorizationCount" class="col-form-label-sm"
              >Authorization Count</label
            >
            <input
              type="number"
              [(ngModel)]="settings.authorizationCount"
              name="authorizationCount"
              min="0"
              class="form-control form-control-sm"
            />
          </div>
        </div>
        <hr />
        <div>
          <mat-checkbox
            [(ngModel)]="settings.hasExternalDB"
            [ngModelOptions]="{ standalone: true }"
            color="accent"
            (change)="addDatabase($event.checked)"
          >
            {{
              settings.hasExternalDB ? "External DB Added" : "Add External DB?"
            }}
          </mat-checkbox>
        </div>
        <hr />
        <div *ngIf="settings.hasExternalDB" class="row">
          <div class="form-group col col-sm-6">
            <label for="dbHost" class="col-form-label-sm">Host</label>
            <input
              type="text"
              [(ngModel)]="settings.dbHost"
              name="dbHost"
              class="form-control form-control-sm"
              placeholder="Enter Database Host"
              required
            />
          </div>
          <div class="form-group col col-sm-6">
            <label for="dbPort" class="col-form-label-sm">Port</label>
            <input
              type="text"
              [(ngModel)]="settings.dbPort"
              name="dbPort"
              class="form-control form-control-sm"
              placeholder="Enter Port Number"
              required
            />
          </div>
          <div class="form-group col col-sm-6">
            <label for="dbName" class="col-form-label-sm">Name</label>
            <input
              type="text"
              [(ngModel)]="settings.dbName"
              name="dbName"
              class="form-control form-control-sm"
              placeholder="Enter Database Name"
              required
            />
          </div>
          <div class="form-group col col-sm-6">
            <label for="dbUser" class="col-form-label-sm">User</label>
            <input
              type="text"
              [(ngModel)]="settings.dbUser"
              name="dbUser"
              class="form-control form-control-sm"
              placeholder="Enter Database User"
              required
            />
          </div>
          <div class="form-group col col-sm-6">
            <label for="dbPassword" class="col-form-label-sm">Password</label>
            <input
              type="text"
              [(ngModel)]="settings.dbPassword"
              name="dbPassword"
              class="form-control form-control-sm"
              placeholder="Enter Database Password"
              required
            />
          </div>
          <div class="form-group col col-sm-6">
            <label for="" class="col-form-label-sm">&nbsp;&nbsp;</label><br />
            <button
              (click)="checDBConnection()"
              class="btn btn-dark btn-sm"
              type="button"
            >
              Check DB Connection
            </button>
          </div>
        </div>
        <hr />

        <button mat-flat-button color="primary" type="submit">
          Save Settings
        </button>
        &nbsp;
        <button
          color="warn"
          mat-flat-button
          [disabled]="isNew"
          routerLink="/dashboard"
          type="button"
        >
          <span>Back Without Saving</span>
        </button>
      </form>
    </div>
  </div>
</main>
