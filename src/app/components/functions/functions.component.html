<div class="container center mt-50">
  <div class="d-flex justify-content-end">
    <button class="btn btn-primary" (click)="navigateToDashboard()">
      Dashboard
    </button>
  </div>
  <h1 class="text-center">Welcome to custom functions setup</h1>
  <div>
    <form [formGroup]="formGroup" class="text-center w-50">
      <mat-form-field class="w-100" appearance="outline">
        <mat-label>Function Name</mat-label>
        <input
          formControlName="name"
          type="text"
          matInput
          placeholder="Function Name"
        />
      </mat-form-field>
      <mat-form-field class="w-100" appearance="outline">
        <mat-label>Function Description</mat-label>
        <input
          formControlName="description"
          type="text"
          matInput
          placeholder="Function Description"
        />
      </mat-form-field>
      <mat-form-field class="w-100" appearance="outline">
        <mat-label>Function Run Interval</mat-label>
        <input
          formControlName="frequency"
          type="text"
          matInput
          placeholder="Function Run Interval"
        />
      </mat-form-field>
    </form>
  </div>
  <div class="text-center d-flex justify-content-between">
    <div>
      <input
        accept="text/javascript"
        class="form-control"
        type="file"
        (change)="onChange($event)"
      />
    </div>
    <div>
      <button
        mat-flat-button
        color="primary"
        (click)="onSave()"
        [disabled]="
          !selectedFx &&
          (!file ||
            !getValue('name') ||
            getValue('name') == '' ||
            !getValue('description') ||
            getValue('description') == '')
        "
        class="btn btn-success"
      >
        Save
      </button>
    </div>
    <h1>{{ totalRows }}</h1>
  </div>

  <app-logs [liveLogText]="liveLogText"></app-logs>

  <table mat-table [dataSource]="processes" class="mat-elevation-z2 table">
    <!-- Name Column -->
    <ng-container class="text-center" matColumnDef="name">
      <th mat-header-cell *matHeaderCellDef>Name</th>
      <td mat-cell *matCellDef="let element">{{ element.name }}</td>
    </ng-container>

    <!-- Description Column -->
    <ng-container matColumnDef="description">
      <th mat-header-cell *matHeaderCellDef>Description</th>
      <td mat-cell *matCellDef="let element">{{ element.description }}</td>
    </ng-container>

    <!-- Frequency Column -->
    <ng-container matColumnDef="frequency">
      <th mat-header-cell *matHeaderCellDef>Frequency</th>
      <td mat-cell *matCellDef="let element">{{ element.frequency }}</td>
    </ng-container>

    <!-- Actions Column -->
    <ng-container matColumnDef="actions" lastButton>
      <th mat-header-cell *matHeaderCellDef>Actions</th>
      <td
        mat-cell
        *matCellDef="let element"
        style="cursor: pointer"
        matRipple
        [matMenuTriggerFor]="appMenu"
      >
        <mat-icon>more_vert</mat-icon>
        <mat-menu #appMenu="matMenu">
          <div role="menu" class="extended-menu-container">
            <div
              class="menu-more-option mat-typography"
              (click)="onEdit(element)"
            >
              <span
                matRipple
                role="menuitem"
                tabindex="0"
                class="extended-menu-option"
              >
                <div>
                  <div class="extended-menu-option-div">
                    <span class="material-icons menu-label" color="#757575"
                      >edit</span
                    >
                    <div class="edit">Edit</div>
                  </div>
                </div>
              </span>
            </div>
            <div
              class="menu-more-option mat-typography"
              (click)="onDelete(element)"
            >
              <span
                matRipple
                role="menuitem"
                tabindex="0"
                class="extended-menu-option"
              >
                <div>
                  <div class="extended-menu-option-div">
                    <span
                      class="material-icons menu-label text-danger"
                      color="#da1f05"
                      >delete</span
                    >
                    <div class="edit">Delete</div>
                  </div>
                </div>
              </span>
            </div>

            <div
              class="menu-more-option mat-typography"
              (click)="onRun(element)"
            >
              <span
                matRipple
                role="menuitem"
                tabindex="0"
                class="extended-menu-option"
              >
                <div>
                  <div class="extended-menu-option-div">
                    <span class="material-icons menu-label-stop" color="#757575"
                      >loop</span
                    >
                    <div class="edit">Run</div>
                  </div>
                </div>
              </span>
            </div>

            <div class="menu-more-option mat-typography">
              <span
                matRipple
                role="menuitem"
                tabindex="0"
                class="extended-menu-option"
              >
                <div>
                  <div class="extended-menu-option-div">
                    <span class="material-icons menu-label-stop" color="#757575"
                      >cancel</span
                    >
                    <div class="edit">Cancel</div>
                  </div>
                </div>
              </span>
            </div>
          </div>
        </mat-menu>
      </td>
    </ng-container>

    <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
    <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
  </table>
  <div class="sticky-paginator">
    <mat-paginator
      #paginator
      [length]="totalRows"
      [pageIndex]="currentPage"
      [pageSize]="pageSize"
      [pageSizeOptions]="pageSizeOptions"
      (page)="pageChanged($event)"
      aria-label="Select page"
      showFirstLastButtons
    >
    </mat-paginator>
  </div>
</div>
